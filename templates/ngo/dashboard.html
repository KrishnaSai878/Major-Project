{% extends "base.html" %}
{% block title %}NGO Dashboard - NGO Connect{% endblock %}
{% block content %}
<div class="min-h-screen pt-24 pb-12" style="background:#0b1220;">
  <div class="container mx-auto px-6">
    <div class="rounded-2xl p-6 mb-8" style="background:#0f172a; box-shadow:0 20px 60px rgba(2,6,23,.35) inset, 0 8px 30px rgba(2,6,23,.25);">
      <div class="flex items-center justify-between gap-4">
        <div>
          <h1 class="text-3xl font-semibold" style="color:#E5E7EB;">{{ ngo.organization_name }}</h1>
          <p class="mt-1" style="color:#9CA3AF;">Manage your organization and volunteer opportunities</p>
        </div>
        <a href="/ngo/events" class="btn btn-primary btn-rounded"><i class="fa-solid fa-calendar-days"></i> Manage Events</a>
      </div>
    </div>

    <div class="grid md:grid-cols-4 gap-6 mb-8">
      <div class="rounded-xl p-6 text-center" style="background:#0f172a; color:#E5E7EB; box-shadow:0 8px 30px rgba(2,6,23,.25);">
        <div class="text-2xl" style="color:#8b5cf6;">{{ (active_events if active_events is defined else total_events) or 0 }}</div>
        <div class="mt-1 text-sm" style="color:#94a3b8;">Active Events</div>
      </div>
      <div class="rounded-xl p-6 text-center" style="background:#0f172a; color:#E5E7EB; box-shadow:0 8px 30px rgba(2,6,23,.25);">
        <div class="text-2xl" style="color:#8b5cf6;">{{ total_volunteers or 0 }}</div>
        <div class="mt-1 text-sm" style="color:#94a3b8;">Total Volunteers</div>
      </div>
      <div class="rounded-xl p-6 text-center" style="background:#0f172a; color:#E5E7EB; box-shadow:0 8px 30px rgba(2,6,23,.25);">
        <div class="text-2xl" style="color:#8b5cf6;">{{ total_hours or 0 }}</div>
        <div class="mt-1 text-sm" style="color:#94a3b8;">Hours Contributed</div>
      </div>
      <div class="rounded-xl p-6 text-center" style="background:#0f172a; color:#E5E7EB; box-shadow:0 8px 30px rgba(2,6,23,.25);">
        <div class="text-2xl" style="color:#8b5cf6;">{{ completed_projects or 0 }}</div>
        <div class="mt-1 text-sm" style="color:#94a3b8;">Completed Projects</div>
      </div>
    </div>

    <div class="grid md:grid-cols-2 gap-6 mb-8">
      <div class="rounded-2xl p-6" style="background:#0f172a; box-shadow:0 8px 30px rgba(2,6,23,.25);">
        <h3 class="text-xl font-semibold mb-2" style="color:#E5E7EB;"><i class="fa-regular fa-calendar-plus"></i> Create New Event</h3>
        <p class="mb-4" style="color:#9CA3AF;">Create a new volunteer opportunity with detailed information and time slots.</p>
        <a href="/ngo/events" class="btn btn-primary btn-rounded"><i class="fa-solid fa-plus"></i> Create New Event</a>
      </div>
      <div class="rounded-2xl p-6" style="background:#0f172a; box-shadow:0 8px 30px rgba(2,6,23,.25);">
        <h3 class="text-xl font-semibold mb-3" style="color:#E5E7EB;"><i class="fa-solid fa-chart-line"></i> Quick Stats</h3>
        <div class="space-y-3" style="color:#E5E7EB;">
          <div class="flex items-center justify-between border-b border-slate-700 pb-2"><span><i class="fa-solid fa-user-group"></i> New volunteers:</span><span style="color:#94a3b8;">{{ new_volunteers or 0 }}</span></div>
          <div class="flex items-center justify-between border-b border-slate-700 pb-2"><span><i class="fa-regular fa-clock"></i> Hours logged:</span><span style="color:#94a3b8;">{{ hours_logged or 0 }}</span></div>
          <div class="flex items-center justify-between border-b border-slate-700 pb-2"><span><i class="fa-regular fa-calendar-check"></i> Events completed:</span><span style="color:#94a3b8;">{{ events_completed or 0 }}</span></div>
          <div class="flex items-center justify-between"><span><i class="fa-regular fa-star"></i> Average rating:</span><span style="color:#94a3b8;">{{ average_rating or '4.8/5' }}</span></div>
        </div>
      </div>
    </div>

    <div class="rounded-2xl p-0 overflow-hidden mb-8" style="background:#0f172a; box-shadow:0 8px 30px rgba(2,6,23,.25);">
      <div class="p-6 border-b border-slate-800"><h3 class="text-xl font-semibold" style="color:#E5E7EB;"><i class="fa-regular fa-calendar-days"></i> Your Events</h3></div>
      <div class="p-0">
        <table class="table" style="color:#E5E7EB;">
          <thead><tr><th>Event</th><th>Date & Time</th><th>Location</th><th>Volunteers</th><th>Status</th><th>Actions</th></tr></thead>
          <tbody>
            {% for e in events %}
            <tr>
              <td>{{ e.title }}</td>
              <td>{{ (e.start_date.strftime('%B %d, %Y at %I:%M %p') if e.start_date else '') }}</td>
              <td>{{ e.city or e.location or '-' }}</td>
              <td>{{ (e.current_volunteers if e.current_volunteers is defined else 0) }} / {{ (e.max_volunteers if e.max_volunteers is defined else '-') }}</td>
              <td><span class="badge {{ 'badge-success' if e.is_active else 'badge-warning' }}">{{ 'Active' if e.is_active else 'Draft' }}</span></td>
              <td class="flex gap-2">
                <a class="btn btn-secondary btn-rounded" href="/ngo/events">Edit</a>
                <a class="btn btn-accent btn-rounded" href="{{ url_for('volunteer_event_detail', event_id=e.id) }}">View</a>
              </td>
            </tr>
            {% else %}
            <tr><td colspan="6" class="muted">No events</td></tr>
            {% endfor %}
          </tbody>
        </table>
      </div>
    </div>

    <div class="grid md:grid-cols-2 gap-6">
      <div class="rounded-2xl p-6" style="background:#0f172a; box-shadow:0 8px 30px rgba(2,6,23,.25); max-height:320px; overflow:auto;">
        <h3 class="text-xl font-semibold mb-3" style="color:#E5E7EB;"><i class="fa-solid fa-users"></i> Recent Volunteers</h3>
        <div class="space-y-4" style="color:#E5E7EB;">
          {% for b in recent_volunteers or [] %}
            <div class="border-b border-slate-700 pb-3">
              <div class="font-semibold">{{ b.name or 'Volunteer' }}</div>
              <div class="text-sm" style="color:#9CA3AF;">Booked: {{ b.event_title or '-' }}</div>
              <div class="text-xs mt-1" style="color:#9CA3AF;">{{ b.when or '' }}</div>
            </div>
          {% else %}
            <div class="text-sm" style="color:#9CA3AF;">No recent volunteers.</div>
          {% endfor %}
        </div>
      </div>
      <div class="rounded-2xl p-6" style="background:#0f172a; box-shadow:0 8px 30px rgba(2,6,23,.25); max-height:320px; overflow:auto;">
        <h3 class="text-xl font-semibold mb-3" style="color:#E5E7EB;"><i class="fa-regular fa-comments"></i> Recent Messages</h3>
        <div class="space-y-4" style="color:#E5E7EB;">
          {% for m in recent_messages or [] %}
            <div class="border-b border-slate-700 pb-3">
              <div class="font-semibold">From: {{ m.sender or 'User' }}</div>
              <div class="text-sm" style="color:#9CA3AF;">"{{ m.text or '' }}"</div>
              <div class="text-xs mt-1" style="color:#9CA3AF;">{{ m.when or '' }}</div>
            </div>
          {% else %}
            <div class="text-sm" style="color:#9CA3AF;">No recent messages.</div>
          {% endfor %}
        </div>
      </div>
    </div>
  </div>
</div>
{% endblock %}
